[{"path":"index.html","id":"introduction","chapter":"1 Introduction","heading":"1 Introduction","text":"Predictive approaches heterogeneity treatment effects (HTE) aim \ndevelopment models predicting either individualized effects two\n() treatments better individual [1]. prior work,\ndivided methods three broader categories based reference class\nused defining patient similarity making individualized predictions \nrecommendations [2]. Risk-modeling approaches use prediction \nbaseline risk reference; treatment effect modeling approaches also model\ntreatment-covariate interactions, addition risk factors; optimal treatment\nregime approaches focus developing treatment assignment rules rely\nheavily modeling treatment effect modifiers.Risk-modeling approaches predictive HTE analyses provide viable option \nabsence well-established treatment effect modifier [3,4]. simulations, modeling treatment-covariate interactions, often led\nmiscalibrated predictions absolute benefit, contrary risk-based\nmethods, despite weaker discrimination benefit presence true\neffect modifiers [5]. often, risk-modeling approaches \ncarried two steps: first risk prediction model developed externally\ninternally entire RCT population, “blinded” treatment; RCT\npopulation stratified using prediction model evaluate risk-based\ntreatment effect variation [6]. approach identified substantial\nabsolute treatment effect differences low-risk high-risk patients \nre-analysis 32 large trials [7]. However, even though estimates \nrisk subgroup level may accurate, estimates may apply \nindividual patients.current simulation study, aim summarize compare different\nrisk-based models predicting treatment effects. simulate different\nrelations baseline risk treatment effects also consider\npotential harms treatment. illustrate different models case study\npredicting individualized effects treatment acute myocardial\ninfarction (MI) large RCT.","code":""},{"path":"methods.html","id":"methods","chapter":"2 Methods","heading":"2 Methods","text":"","code":""},{"path":"methods.html","id":"notation","chapter":"2 Methods","heading":"2.1 Notation","text":"observe RCT data \\((Z, X, Y)\\), patient \\(Z_i= 0, 1\\) \ntreatment status, \\(Y_i = 0, 1\\) observed outcome \\(X_i\\) set \nmeasured covariates. Let \\(\\{Y_i(z), z=0, 1\\}\\) denote unobservable potential\noutcomes. observe \\(Y_i = Z_iY_i(1) + (1 - Z_i)Y_i(0)\\). interested \npredicting conditional average treatment effect (CATE),\n\\[\\tau(x) = E\\{Y(0) - Y(1)|X=x\\}\\]\nAssuming \\((Z, X, Y)\\) random sample target population \n\\(\\big(Y(0), Y(1)\\big)\\perp \\!\\!\\! \\perp Z|X\\), RCT setting, can predict\nCATE \n\\[\\begin{align*}\n\\tau(x) &= E\\{Y(0)\\:\\vert\\:X=x\\}-E\\{Y(1)\\:\\vert\\:X=x\\}\\\\\n&=E\\{Y\\:\\vert\\:X=x, Z=0\\}-E\\{Y\\:\\vert\\:X=x, Z=1\\}\n\\end{align*}\\]","code":""},{"path":"methods.html","id":"simulation-scenarios","chapter":"2 Methods","heading":"2.2 Simulation scenarios","text":"simulated typical RCT, comparing equally-sized treatment control arms\nterms binary outcome. patient generated 8 baseline\ncovariates \\(x_1,\\dots,x_4\\sim N(0, 1)\\) \\(x_5,\\dots,x_8\\sim B(1,0.2)\\). Outcomes control arm generated Bernoulli variables\ntrue probabilities following logistic regression model including \nbaseline covariates, .e.\n\\(P(Y(0)=1\\:\\vert\\:X=x) = \\text{expit}(lp_0) = e^{lp_0}/(1+e^{lp_0})\\),\n\\(lp_0=lp_0(x)=x^t\\beta\\).\nbase scenarios coefficient values \\(\\beta\\) \n, AUC logistic regression model 0.75 event rate\ncontrol arm \\(20\\%\\).Outcomes treatment arm first generated using 3 simple scenarios:\nabsent (= 1), moderate (= 0.8) strong (= 0.5) constant relative\ntreatment effect. introduced linear, quadratic non-monotonic\ndeviations constant treatment effects using:\n\\[lp_1 = \\gamma_2(lp_0-c)^2 + \\gamma_1(lp_0-c) + \\gamma_0, \\]\n\\(lp_1\\) true linear predictor treatment arm, \n\\(P(Y(1)=1\\:\\vert\\:X=x) = \\text{expit}(lp_1)\\).\nFinally, incorporated constant absolute harms treated patients, \n\n\\(P(Y(1)=1|X=x) = \\text{expit}(lp_1) + \\text{harm}\\).sample size base scenarios set 4,250 (80% power \ndetection marginal 0.8 standard alpha 5%). evaluated\neffect smaller larger sample sizes 1,063 17,000,\nrespectively. also evaluated effect risk model discriminative ability,\nadjusting baseline covariate coefficients, AUC \nregression model control arm 0.65 0.85, respectively.settings resulted simulation study 648 scenarios covering \nobserved HTE 32 large trials well many potential variations \nrisk-based treatment effect (Supplement, Sections 2 3) [7].","code":""},{"path":"methods.html","id":"individualized-risk-based-benefit-predictions","chapter":"2 Methods","heading":"2.3 Individualized risk-based benefit predictions","text":"simulation run internally developed prediction model entire\npopulation, using logistic regression main effects baseline\ncovariates treatment assignment. Individual risk predictions derived \nsetting treatment assignment 0. Another approach derive \nprediction model solely control patients; however, shown \nlead biased benefit predictions [5,8,9].stratified HTE method suggested alternative traditional\nsubgroup analyses [3,4]. Patients stratified \nequally-sized risk strata—case based risk quartiles. Absolute\ntreatment effects within risk strata estimated difference event\nrate control treatment arm patients. considered approach \nreference, expecting perform worse candidates, \nobjective provide illustration HTE rather optimize\nindividualized benefit predictions.Second, considered model assumes constant relative treatment effect\n(constant odds ratio). Hence, absolute benefit predicted \n\\(\\tau(x;\\hat{\\beta}) = \\text{expit}(\\hat{lp}_0) - \\text{expit}(\\hat{lp}_0+\\delta_0)\\), \n\\(\\delta_0\\) log assumed constant odds ratio \n\\(\\hat{lp}_0 = \\hat{lp}_0(x;\\hat{\\beta}) = x^t\\hat{\\beta}\\)\nlinear predictor estimated baseline risk model.Third, considered logistic regression model including treatment, \nprognostic index, linear interaction. Absolute benefit \nestimated \n\\(\\tau(x;\\hat{\\beta}) = \\text{expit}(\\delta_0+\\delta_1\\hat{lp}_0) - \\text{expit}(\\delta_0+\\delta_2+(\\delta_1+\\delta_3)\\hat{lp}_0)\\)\nrefer method linear interaction approach.Fourth, used restricted cubic splines (RCS) relax linearity\nassumption effect linear predictor [10]. considered\nsplines 3 (RCS-3), 4 (RCS-4) 5 (RCS-5) knots compare models \ndifferent levels flexibility.Finally, considered adaptive approach using Akaike’s Information Criterion\n(AIC) model selection. specifically, ranked constant relative\ntreatment effect model, linear interaction model, RCS models 3,\n4, 5 knots based AIC selected one lowest\nvalue. extra degrees freedom 1 (linear interaction), 2, 3 4 (RCS\nmodels) increasingly complex interactions treatment effect.","code":""},{"path":"methods.html","id":"evaluation-metrics","chapter":"2 Methods","heading":"2.4 Evaluation metrics","text":"evaluated predictive accuracy considered methods root mean\nsquared error (RMSE):\\[\\text{RMSE}=\\sqrt{\\frac{1}{n}\\sum_{=1}^n\\big(\\tau(x_i) - \\hat{\\tau}(x_i)\\big)^2}\\]compared discriminative ability methods study using\nc--benefit integrated calibration index (ICI) \nbenefit (Supplement, Section 6) [11].scenario performed 500 replications, within considered\nmodels fitted. simulated super-population size 500,000 \nscenario within calculated RMSE discrimination calibration \nbenefit models replication.","code":""},{"path":"methods.html","id":"empirical-illustration","chapter":"2 Methods","heading":"2.5 Empirical illustration","text":"demonstrated different methods using 30,510 patients acute\nmyocardial infarction (MI) included GUSTO-trial. 10,348 patients randomized tissue\nplasminogen activator (tPA) treatment 20,162 randomized streptokinase. outcome interest\n30-day mortality (total 2,128 events), recorded \npatients. line previous analyses [12,13], \nfitted logistic regression model 6 baseline covariates, .e. age, Killip\nclass, systolic blood pressure, heart rate, indicator previous MI, \nlocation MI, predict 30-day mortality risk (Supplement, Section 8).","code":""},{"path":"results.html","id":"results","chapter":"3 Results","heading":"3 Results","text":"","code":""},{"path":"results.html","id":"simulations","chapter":"3 Results","heading":"3.1 Simulations","text":"constant treatment effect approach outperformed approaches base\ncase scenario (N = 4,250; = 0.8; AUC= 0.75; absolute treatment harm)\ntrue constant treatment effect (median RMSE: constant treatment effect\n0.009;\nlinear interaction 0.014;\nRCS-3 0.018).\nlinear interaction model optimal true linear deviations\n(median RMSE: constant treatment effect\n0.027;\nlinear interaction 0.015;\nRCS-3 0.018; Figure  panels -C)\neven presence true quadratic deviations\n(median RMSE: constant treatment effect\n0.057;\nlinear interaction 0.020;\nRCS-3 0.021; Figure  panels -C)\nconstant relative treatment effect. non-monotonic deviations, RCS-3\nslightly outperformed linear interaction model\n(Median RMSE: linear interaction 0.019;\nRCS-3 0.018; Figure  panel D).\nstrong treatment-related harms results similar \nscenarios (Figure  panels -C). non-monotonic deviations\noptimal performance RCS-3 pronounced\n(Median RMSE: linear interaction 0.024;\nRCS-3 0.019; Figure  panel D).\nstronger average treatment effect (=0.5) led larger absolute benefit\npredictions consequently larger RMSE approaches, relative\ndifferences different approaches similar base case scenario\n(Supplement, Figure S10).\nFigure 3.1: RMSE considered methods across 500 replications calculated simulated super-population size 500,000. scenario true constant relative treatment effect (panel ) true prediction AUC 0.75 sample size 4250. RMSE also presented strong linear (panel B), strong quadratic (panel C), non-monotonic (panel D) constant relative treatment effects. Panels right side present true relations baseline risk (x-axis) absolute treatment benefit (y-axis). 2.5, 25, 50, 75, 97.5 percentiles risk distribution expressed boxplot top. 2.5, 25, 50, 75, 97.5 percentiles true benefit distributions expressed boxplots side right-handside panel.\nadaptive approach limited loss performance terms median\nRMSE best-performing method scenario. However, compared \nbest-performing approach, RMSE variable scenarios linear\nnon-monotonic deviations, especially also including moderate strong\ntreatment-related harms. closer inspection, found behavior \ncaused selecting constant treatment effect model substantial\nproportion replications (Supplement, Figure S3).Increasing sample size 17,000 favored RCS-3 . difference \nperformance linear interaction approach limited settings\nconstant treatment effect\n(Median RMSE: linear interaction 0.007;\nRCS-3 0.009) true linear interaction\n(Median RMSE: linear interaction 0.008;\nRCS-3 0.009).\nemphasized settings strong quadratic deviations\n(Median RMSE: linear interaction 0.013;\nRCS-3 0.011) non-monotonic deviations\n(Median RMSE: linear interaction 0.014;\nRCS-3 0.010).\nDue large sample size, RMSE adaptive approach even \nsimilar best-performing method, constant relative treatment\neffect model less often wrongly selected (Supplement, Figure S4).\nFigure 3.2: RMSE considered methods across 500 replications calculated simulated samples size 17,000 rather 4,250 Figure . RMSE calculated super-population size 500,000\nSimilarly, increased AUC true prediction model 0.85 (=\n0.8 N = 4,250), RCS-3 lowest RMSE case strong quadratic \nnon-monotonic deviations comparable performance – optimal –\nlinear interaction model case strong linear deviations (median RMSE \n0.016 RCS-3 compared \n0.014 linear interaction\nmodel). Similar base case scenario adaptive approach wrongly selected\nconstant treatment effect model\n(23%\n\n25%\nreplications \nstrong linear non-monotonic deviation scenarios without treatment-related\nharms, respectively), leading increased variability RMSE (Supplement,\nFigure S5).\nFigure 3.3: RMSE considered methods across 500 replications calculated simulated samples 4,250. True prediction AUC 0.85. RMSE calculated super-population size 500,000\ntrue constant relative treatment effect, discrimination benefit \nslightly lower linear interaction model, substantially lower\nnon-linear RCS approaches (Figure ; panel\n). strong linear quadratic deviations constant relative\ntreatment effect, methods discriminated quite similarly (Figure\n; panels B-C). non-monotonic deviations, \nconstant effect model much lower discriminative ability compared \nmethods\n(median AUC 0.500 constant effects model,\n0.528\nlinear interaction model \n0.530\nFigure ; panel D).\nadaptive approach unstable terms discrimination benefit,\nespecially treatment-related harms. increasing number RCS knots, \nobserved decreasing median values increasing variability \nc--benefit scenarios. increased sample size 17,000 \nobserved similar trends, however performance methods stable\n(Supplement, Figure S6). Finally, increased true prediction AUC \n0.85 adaptive approach , , conservative, especially \nnon-monotonic deviations null moderate treatment-related harms\n(Supplement, Figure S5).\nFigure 3.4: Discrimination benefit considered methods across 500 replications calculated simulated samples size 4,250. True prediction AUC 0.75.\nterms calibration benefit, constant effects model outperformed \nmodels scenario true constant treatment effects, \nmiscalibrated deviation scenarios (Figure ). \nlinear interaction model showed best close best calibration across \nscenarios outperformed RCS-3 case non-monotonic\ndeviations treatment-related harms (Figure ; panel\nD). adaptive approach worse calibrated strong linear \nnon-monotonic deviations compared linear interaction model \nRCS-3. increased sample size 17,000 (Supplement, Figure S6) \ntrue prediction AUC 0.85 (Supplement, Figure S7), RCS-3 somewhat\nbetter calibrated linear interaction model strong quadratic\ndeviations.\nFigure 3.5: Calibration benefit considered methods across 500 replications calculated simulated sample size 500,000. True prediction AUC 0.75 sample size 4,250.\nresults individual scenarios can explored online \nhttps://arekkas.shinyapps.io/simulation_viewer/. Additionally,\ncode simulations can found \nhttps://github.com/rekkasa/arekkas_HteSimulation_XXXX_2021","code":""},{"path":"results.html","id":"empirical-illustration-1","chapter":"3 Results","heading":"3.2 Empirical illustration","text":"used derived prognostic index fit constant treatment effect, \nlinear interaction RCS-3 model individualizing absolute benefit\npredictions. Following simulation results, RCS-4 RCS-5 models \nexcluded. Finally, adaptive approach 3 candidate models applied.considered methods provided similar fits, predicting increasing benefits \npatients higher baseline risk predictions, followed evolution \nstratified estimates closely (Figure ). constant\ntreatment effect model somewhat lower AIC compared linear interaction\nmodel (AIC:\n9,336 versus\n9,342),\nequal cross-validated discrimination\n(c--benefit:\n0.525),\nslightly better cross-validated calibration\n(ICI-benefit:\n0.010 versus\n0.012).\nconclusion, although sample size (30,510 patients;\n2,128 events) allowed flexible modeling approaches, \nsimpler constant treatment effect model adequate predicting absolute\n30-day mortality benefits treatment tPA patients acute MI.\nFigure 3.6: Individualized absolute benefit predictions based baseline risk using constant treatment effect approach, linear interaction approach RCS smoothing using 3 knots. Risk stratified estimates absolute benefit presented within quartiles baseline risk reference.\n","code":""},{"path":"discussion.html","id":"discussion","chapter":"4 Discussion","heading":"4 Discussion","text":"linear interaction RCS-3 models displayed good performance\nmany considered simulation scenarios. linear interaction model\noptimal cases moderate sample sizes (4.250 patients; ~785 events)\nmoderately performing baseline risk prediction models, , lower\nRMSE, better calibrated benefit better discrimination \nbenefit, even scenarios strong quadratic deviations. scenarios \ntrue non-monotonic deviations, linear interaction model outperformed \nRCS-3, especially presence treatment-related harms. Increasing \nsample size prediction model’s discriminative ability favored RCS-3,\nespecially scenarios strong non-linear deviations constant\ntreatment effect.simulation results clearly express trade-advantages \nflexibly modeling relationship baseline risk treatment effect\ndisadvantages overfitting relationship sample hand. \ninfinite sample size, flexible approach (RCS) optimal, \npractice, limited sample size, parsimonious models may \npreferable. Even substantial sample size base case scenario, \n(less flexible) linear interaction model performed better (\nflexible) RCS approach simulation settings. even less flexible\nconstant treatment effect model, however, optimal treatment\neffect truly constant. Moreover, assumption constant treatment\neffect may often strong [7,14]. example, infants\nlower risk bronchopulmonary dysplasia benefit relatively vitamin\ntherapy infants higher risk [15]; higher risk prediabetic\npatients benefit relatively metformin lower risk patients\n[16]. Hence, linear interaction baseline risk effect\ntreatment may sensible approach moderate sample sizes.RCS-4 RCS-5 flexible considered scenarios, indicated \nhigher RMSE, increased variability discrimination benefit worse\ncalibration benefit predictions. Even larger sample sizes strong\nquadratic non-monotonic deviations, flexible methods \noutperform simpler RCS-3 approach. Higher flexibility may helpful\nextreme patterns HTE compared quadratic deviations\nconsidered . Considering interactions RCS-3 models complex\napproach often may reasonable.Increasing discriminative ability risk model reduced RMSE \nmethods. Higher discrimination translates higher variability predicted\nrisks, , turn, allows considered methods better capture absolute\ntreatment benefits. consequence, better risk discrimination also led \nhigher discrimination low high benefit (reflected \nvalues c--benefit).adaptive approach adequate median performance, following “true”\nmodel scenarios. smaller sample sizes tended miss \ntreatment-baseline risk interaction selected simpler models (Supplement\nSection 4). conservative behavior resulted increased RMSE variability \nscenarios, especially true strong linear non-monotonic\ndeviations. Therefore, smaller sample sizes simpler linear interaction\nmodel may safer choice predicting absolute benefits, especially \npresence suspected treatment-related harms.One limitation assumed treatment benefit function baseline\nrisk majority simulation scenarios. attempted expand \nscenarios considering constant moderate strong treatment-related harms,\napplied absolute scale, line previous work [17]. \nlimited set scenarios true interactions treatment assignment \ncovariates, conclusions remained unchanged (Supplement, Section 7). Even\nthough average error rates increased considered methods, due \nmiss-specification outcome model, linear interaction model \nlowest error rates. RCS-3 comparable performance. constant\ntreatment effect model often biased, especially moderate strong\ntreatment-related harms. Future simulation studies explore effect \nextensive deviations risk-based treatment effects.focused risk-based methods, using baseline risk reference \ntwo-stage approach individualizing benefit predictions. However, \nplethora different methods, ranging treatment effect modeling \ntree-based approaches available recent literature [18–21]. Many methods rely incorporating\ntreatment-covariate interactions predicting benefit. important caveat \napproaches sensitivity overfitting, may exaggerate \nmagnitude predicted benefits. wide range simulation settings, \nsimpler risk modeling approach consistently better calibrated benefit\ncompared complex treatment effect modelling approaches\n[5]. Similarly, SYNTAX score II, model developed \nidentifying patients complex coronary artery disease benefit \npercutaneous coronary intervention coronary artery bypass grafting \nredeveloped using fewer treatment-covariate interactions better external\nperformance compared predecessor [22,23]. However, whether remains case range\nempirical settings still needs explored.conclusion, linear interaction approach viable option moderate\nsample sizes /moderately performing risk prediction models, assuming \nnon-constant relative treatment effect plausible. RCS-3 better option \nabundant sample size non-monotonic deviations constant\nrelative treatment effect /substantial treatment-related harms \nanticipated. Increasing complexity RCS models increasing \nnumber knots improve benefit prediction. Using AIC model\nselection attractive larger sample size.","code":""},{"path":"supplement.html","id":"supplement","chapter":"5 Supplement","heading":"5 Supplement","text":"","code":""},{"path":"supplement.html","id":"notation-1","chapter":"5 Supplement","heading":"5.1 Notation","text":"observe RCT data \\((Z, X, Y)\\), patient \\(Z_i= 0, 1\\) \ntreatment status, \\(Y_i = 0, 1\\) observed outcome \\(X_i\\) set \ncovariates measured. Let \\(\\{Y_i(z), z=0, 1\\}\\) denote unobservable potential\noutcomes. observe \\(Y_i = Z_iY_i(1) + (1 - Z_i)Y_i(0)\\). interested \npredicting conditional average treatment effect (CATE),\n\\[\\tau(x) = E\\{Y(0) - Y(1)|X=x\\}\\]\nAssuming \\((Z, X, Y)\\) random sample target population \n\\(\\big(Y(0), Y(1)\\big)\\perp \\!\\!\\! \\perp Z|X\\), RCT setting, can predict\nCATE \n\\[\\begin{align*}\n\\tau(x) &= E\\{Y(0)\\:\\vert\\:X=x\\}-E\\{Y(1)\\:\\vert\\:X=x\\}\\\\\n&=E\\{Y\\:\\vert\\:X=x, Z=0\\}-E\\{Y\\:\\vert\\:X=x, Z=1\\}\n\\end{align*}\\]Based estimate baseline risk\n\\[\nE\\{Y\\:\\vert\\:X=x, Z=0\\}=g\\big(\\hat{lp}(x)\\big)\n\\]\n\\(\\hat{u}=\\hat{lp}(x)=x^t\\hat{\\beta}\\) linear predictor \\(g\\) link function,\npredict CATE \n\\[\n\\hat{\\tau}(x) = g\\big(f(\\hat{u}, 0)\\big) - g\\big(f(\\hat{u}, 1)\\big)\n\\]\n\\(f(u,z)\\) describes interactions baseline risk linear predictor \ntreatment.","code":""},{"path":"supplement.html","id":"simulation-settings","chapter":"5 Supplement","heading":"5.2 Simulation settings","text":"patients observe covariates \\(X_1,\\dots,X_8\\), \\(4\\) \ncontinuous \\(4\\) binary. specifically,\\[\\begin{equation*}\nX_1,\\dots,X_4 \\sim N(0, 1)\n\\end{equation*}\\]\n\\[\\begin{equation*}\nX_5,\\dots,X_8 \\sim B(1, 0.2)\n\\end{equation*}\\]first, generate binary outcomes \\(Y\\) untreated patients (\\(Z=0\\)),\nbased \\[\\begin{equation} \nP(Y=1\\:\\vert\\:X=x, Z=0) = g(\\beta_0 + \\beta_1x_1+\\dots+\\beta_8x_8) = g(lp_0),\n\\tag{5.1}\n\\end{equation}\\]\\[g(x) = \\frac{e^x}{1+e^x}\\]treated patients, outcomes generated :\\[\\begin{equation}\nP(Y = 1\\:\\vert\\:X=x, Z=1) = g(lp_1)\n\\tag{5.2}\n\\end{equation}\\]\\[lp_1 = \\gamma_2(lp_0-c)^2+\\gamma_1(lp_0-c)+\\gamma_0\\]","code":""},{"path":"supplement.html","id":"base-case-scenario","chapter":"5 Supplement","heading":"5.3 Base-case scenario","text":"base-case scenario assumes constant odds ratio \\(0.8\\) favor \ntreatment. simulated datasets size \\(n=4250\\), treatment \nallocated random using 50/50 split (80% power detection \nunadjusted 0.8, assuming event rate 20% untreated\narm). Outcome incidence untreated population set \\(20\\%\\). \ndevelopment prediction model use model defined (5.1)\nincluding constant treatment effect. predictions, \\(Z\\) set \n\\(0\\). value true \\(\\beta\\) prediction model\nAUC \\(0.75\\).previously defined targets achieved \\(\\beta=(-2.08, 0.49,\\dots,0.49)^t\\). derivations treatment arm use\n\\(\\gamma=(\\log(0.8), 1, 0)^t\\).","code":""},{"path":"supplement.html","id":"deviations-from-base-case","chapter":"5 Supplement","heading":"5.4 Deviations from base-case","text":"deviate base-case scenario two ways. First, alter overall\ntarget settings sample size, overall treatment effect prediction model\nAUC. second stage, consider settings violate assumption \nconstant relative treatment effect, using model-based approach.first part, consider:Sample size:\n\\(n=1064\\)\n\\(n=17000\\)\n\\(n=1064\\)\\(n=17000\\)Overall treatment effect:\n\\(=0.5\\)\n\\(=1\\)\n\\(=0.5\\)\\(=1\\)Prediction performance:\n\\(AUC=0.65\\)\n\\(AUC=0.85\\)\n\\(AUC=0.65\\)\\(AUC=0.85\\)set true risk model coefficients \n\\(\\bm{\\beta} = \\big(-1.63,0.26,\\dots,0.26\\big)^t\\) \\(AUC=0.65\\) \\(\\bm{\\beta} = \\big(-2.7,0.82,\\dots,0.82\\big)^t\\)\n\\(AUC=0.85\\). cases, \\(\\beta_0\\) selected event rate \n\\(20\\%\\) maintained control arm.second part linear, quadratic non-monotonic deviations \nassumption constant relative effect considered. also consider\ndifferent intensity levels deviations. Finally, constant absolute\ntreatment-related harms introduced, .e. positive\n(\\(0.25\\times\\text{true average benefit}\\)),\nstrong positive (\\(0.50\\times\\text{true average benefit}\\)) negative\n(\\(-0.25\\times\\text{true average benefit}\\); .e. constant absolute\ntreatment-related benefit). case true absent treatment effects,\ntreatment-related harms set \\(1\\%, 2\\%\\) \\(-1\\%\\) positive, strong\npositive negative setting, respectively. settings deviations\ndefined Table 5.1.\nTable 5.1: Scenario settings entire simulation study.\n","code":""},{"path":"supplement.html","id":"plausible-scenario-settings","chapter":"5 Supplement","heading":"5.5 Plausible scenario settings","text":"section present specific scenarios simulation settings \nevolution benefit followed similar patterns [7]. \ncase patients stratified risk quarters based true baseline\nrisk. Within risk quarter constructed boxplots true benefit.","code":""},{"path":"supplement.html","id":"approaches-to-individualize-benefit-predictions","chapter":"5 Supplement","heading":"5.6 Approaches to individualize benefit predictions","text":"","code":""},{"path":"supplement.html","id":"risk-modeling","chapter":"5 Supplement","heading":"5.6.1 Risk modeling","text":"Merging treatment arms, develop prediction models including constant relative treatment effect:\\[\\begin{equation}\nP(Y=1\\:\\vert\\:X=x,Z=z) = g(x^t\\beta + \\gamma z)\n\\tag{5.3}\n\\end{equation}\\]derive baseline risk predictions patients setting \\(Z=0\\) \n(5.3). methods individualizing benefit predictions 2-stage\nmethods, start fitting model predicting baseline risk. \nestimated linear predictor model \\[\\begin{equation*}\n\\hat{lp} = lp(x;\\hat{\\beta}) = x^t\\hat{\\beta}\n\\end{equation*}\\]","code":""},{"path":"supplement.html","id":"risk-stratification","chapter":"5 Supplement","heading":"5.6.2 Risk stratification","text":"Derive prediction model using approach divide \npopulation equally sized risk-based subgroups. Estimate subgroup-specific\nabsolute benefit observed absolute differences. Subject-specific\nbenefit predictions made attributing individuals corresponding\nsubgroup-specific estimate.","code":""},{"path":"supplement.html","id":"constant-treatment-effect","chapter":"5 Supplement","heading":"5.6.3 Constant treatment effect","text":"Assuming constant relative treatment effect, fit adjusted model \n(5.3). , predict absolute benefit using\\[\\begin{equation}\n\\hat{\\tau}(x;\\hat{\\beta},\\hat{\\gamma})=g(f(\\hat{lp}, 0)) - g(f(\\hat{lp},1)), \n\\tag{5.4}\n\\end{equation}\\]\\(f(\\hat{lp}, z) = \\hat{lp}+\\hat{\\gamma}z\\), \\(\\hat{\\gamma}\\) \nestimated relative treatment effect (log odds ratio).","code":""},{"path":"supplement.html","id":"linear-interaction","chapter":"5 Supplement","heading":"5.6.4 Linear interaction","text":"relax assumption constant relative treatment effect \n(5.4) setting\\[ f(\\hat{lp}, z) = \\gamma_0+\\gamma_1z+\\gamma_2\\hat{lp}+\\gamma_3z\\hat{lp} \\]","code":""},{"path":"supplement.html","id":"restricted-cubic-splines","chapter":"5 Supplement","heading":"5.6.5 Restricted cubic splines","text":"Finally, drop linearity assumption predict absolute benefit using\nsmoothing restricted cubic splines \\(k=3, 4\\) \\(5\\) knots. \nspecifically, set:\\[ f(\\hat{lp}, z) = \\gamma_0 + \\gamma_1z+zs(\\hat{lp}) \\]\n\n\\[s(x)=\\alpha_0+\\alpha_1h_1(x)+\\alpha_2h_2(x)+\\dots+\\alpha_{k-1}h_{k-1}(x)\\]\n\\(h_1(x)=x\\) \\(j=2,\\dots,k-2\\)\n\\[h_{j+1}(x)= (x-t_j)^3-(x-t_{k-1})_+^3 \\frac{t_k-t_j}{t_k-t_{k-1}}+(x-t_k)^3_+\\frac{t_{k-1}-t_j}{t_k-t_{k-1}}\\]\n\n\\(t_1,\\dots,t_k\\) selected knots [24].","code":""},{"path":"supplement.html","id":"adaptive-model-selection-frequencies","chapter":"5 Supplement","heading":"5.7 Adaptive model selection frequencies","text":"\nFigure 5.1: Model selection frequencies adaptive approach based Akaike’s Information Criterion across 500 replications. scenario true constant relative treatment effect (first panel) true prediction AUC 0.75 sample size 4,250.\n\nFigure 5.2: Model selection frequencies adaptive approach based Akaike’s Information Criterion across 500 replications. Sample size 17,000 rather 4,250 Figure \n\nFigure 5.3: Model selection frequencies adaptive approach based Akaike’s Information Criterion across 500 replications. AUC 0.85 rather 0.75 Figure \n","code":""},{"path":"supplement.html","id":"discrimination-and-calibration-for-benefit","chapter":"5 Supplement","heading":"5.8 Discrimination and calibration for benefit","text":"c--benefit represents probability two randomly chosen\nmatched patient pairs unequal observed benefit, pair greater\nobserved benefit also higher predicted benefit. able calculate\nobserved benefit, patients treatment arm ranked based \npredicted benefit matched 1:1 across treatment arms. Observed treatment\nbenefit defined difference observed outcomes untreated\ntreated patient matched patient pair. Predicted benefit \ndefined average predicted benefit within matched patient pair.evaluated calibration similar manner, using integrated calibration\nindex (ICI) benefit [25]. observed benefits regressed \npredicted benefits using locally weighted scatterplot smoother (loess). \nICI--benefit average absolute difference predicted smooth\nobserved benefit. Values closer represent better calibration.\nFigure 5.4: Discrimination benefit considered methods across 500 replications calculated simulated sample size 500,000. True prediction AUC 0.75 sample size 17,000\n\nFigure 5.5: Discrimination benefit considered methods across 500 replications calculated simulated sample size 500,000. True prediction AUC 0.85 sample size 4,250\n\nFigure 5.6: Calibration benefit considered methods across 500 replications calculated simulated sample size 500,000. True prediction AUC 0.75 sample size 17,000\n\nFigure 5.7: Calibration benefit considered methods across 500 replications calculated simulated sample size 500,000. True prediction AUC 0.85 sample size 4,250\n","code":""},{"path":"supplement.html","id":"strong-relative-treatment-effect","chapter":"5 Supplement","heading":"5.9 Strong relative treatment effect","text":"present root mean squared error considered methods using\nstrong constant relative treatment effect (\\(\\text{}=0.5\\)) \nreference. , sample size prediction performance settings \nconsidered along settings linear, quadratic non-monotonic\ndeviations base case scenario constant relative treatment effects\nconsidered. results can found \nhttps://arekkas.shinyapps.io/simulation_viewer/.\nFigure 5.8: RMSE considered methods across 500 replications calculated simulated super-population size 500,000. scenario true constant relative treatment effect (panel ) true prediction AUC 0.75 sample size 4,250. RMSE also presented strong linear (panel B), strong quadratic (panel C), non-monotonic (panel D) deviations constant relative treatment effects. Panels right side present true relationship baseline risk (x-axis) absolute treatment benefit (y-axis). 2.5, 25, 75 97.5 percentiles risk distribution expressed boxplot.\n\nFigure 5.9: RMSE considered methods across 500 replcations calculated simulated sample size 500,000. Sample size 17,000 rather 4,250 Figure .\n\nFigure 5.10: RMSE considered methods across 500 replcations calculated simulated sample size 500,000. AUC 0.85 rather Figure .\n","code":""},{"path":"supplement.html","id":"treatment-interactions","chapter":"5 Supplement","heading":"5.10 Treatment interactions","text":"carried smaller set simulations, assumed true\ntreatment-covariate interactions. Sample size set 4,250 AUC \ntrue prediction model set 0.75. following scenarios \nconsidered: 1) 4 true weak positive interactions\n(\\(\\text{}_{Z=1} / \\text{}_{Z=0}=0.83\\)); 2) 4 strong positive\ninteractions (\\(\\text{}_{Z=1} / \\text{}_{Z=0}=0.61\\)); 3) 2 weak 2\nstrong positive interactions; 4) 4 weak negative interactions\n(\\(\\text{}_{Z=1} / \\text{}_{Z=0}=1.17\\)); 5) 4 strong negative interactions\n(\\(\\text{}_{Z=1} / \\text{}_{Z=0}=1.39\\)); 6) 2 weak 2 strong negative\ninteractions; 7) combined positive negative strong interactions. also\nconsidered constant treatment-related harms applied absolute scale \ntreated patients. exact settings : 1) absent treatment-related harms; 2)\nmoderate treatment-related harms, defined 25% average true benefit \nscenario without treatment-related harms; 3) strong treatment-related harms\ndefined 50% true average benefit scenario without\ntreatment-related harms; 4) negative treatment-related harms (benefit), defined\nabsolute risk reduction treated patients 50% true average\nbenefit scenario without treatment-related harms. exact settings can\nfound Table 5.2.\nTable 5.2: Scenario settings treatment-covariate interaction scenarios.\n\nFigure 5.11: RMSE considered methods across 500 replications calculated simulated sample size 500,000 treatment-covariate interactions favoring treatment considered.\n\nFigure 5.12: RMSE considered methods across 500 replications calculated simulated sample size 500,000 treatment-covariate interactions favoring control considered.\n\nFigure 5.13: RMSE considered methods across 500 replications calculated simulated sample size 500,000 treatment-covariate interactions 2 favoring treatment 2 favoring control considered.\n","code":""},{"path":"supplement.html","id":"empirical-illustration-2","chapter":"5 Supplement","heading":"5.11 Empirical illustration","text":"predicting baseline risk 30-day mortality fitted logistic regression\nmodel age, Killip class (Killip), systolic blood pressure (sysbp),\npulse rate (pulse), prior myocardial infarction (pmi), location \nmyocardial infarction (miloc) treatment covariates. Baseline\npredictions made setting treatment 0.\\[\\begin{equation*}\nP(outcome=1|X=x) = \\text{expit}(lp(x)),\n\\tag{5.5}\n\\end{equation*}\\]\n\n\\[\\begin{equation*}\n\\begin{aligned}\nlp(x)=& \\beta_0 + \\beta_1 \\text{age} + \\beta_2 (\\text{Killip}=II) + \\beta_3I(\\text{Killip}=III) +\\\\\n&\\beta_4 (\\text{Killip}=IV) + \\beta_5min(\\text{sysbp}, 120) + \\beta_6 \\text{pulse}+\\\\\n&\\beta_7 max(\\text{pulse - 50, 0}) + \\beta_8 (\\text{pmi}=yes)+\\\\\n&\\beta_9 (\\text{miloc}=Anterior) + \\beta_9 (\\text{miloc}=) +\\\\\n&\\gamma\\times\\text{treatment}\n\\end{aligned}\n\\tag{5.6}\n\\end{equation*}\\]\\(expit(x) = \\frac{e^x}{1+e^x}\\)","code":""},{"path":"references.html","id":"references","chapter":"6 References","heading":"6 References","text":"[1] Varadhan R, Segal JB, Boyd CM, Wu AW, Weiss CO. framework analysis heterogeneity treatment effect  patient-centered outcomes research. Journal Clinical Epidemiology 2013;66:818–25. https://doi.org/10.1016/j.jclinepi.2013.02.009.[2] Rekkas , Paulus JK, Raman G, Wong JB, Steyerberg EW, Rijnbeek PR, et al. Predictive approaches heterogeneous treatment effects: scoping review. BMC Medical Research Methodology 2020;20. https://doi.org/10.1186/s12874-020-01145-1.[3] Kent DM, Paulus JK, Klaveren D van, D’Agostino R, Goodman S, Hayward R, et al. predictive approaches treatment effect heterogeneity (PATH) statement. Annals Internal Medicine 2019;172:35. https://doi.org/10.7326/m18-3667.[4] Kent DM, Klaveren D van, Paulus JK, D’Agostino R, Goodman S, Hayward R, et al. predictive approaches treatment effect heterogeneity (PATH) statement: Explanation elaboration. Annals Internal Medicine 2019;172:W1. https://doi.org/10.7326/m18-3668.[5] Klaveren D van, Balan TA, Steyerberg EW, Kent DM. Models interactions overestimated heterogeneity treatment effects prone treatment mistargeting. Journal Clinical Epidemiology 2019;114:72–83. https://doi.org/10.1016/j.jclinepi.2019.05.029.[6] Kent DM, Rothwell PM, Ioannidis JP, Altman DG, Hayward RA. Assessing reporting heterogeneity treatment effects clinical trials: proposal. Trials 2010;11. https://doi.org/10.1186/1745-6215-11-85.[7] Kent DM, Nelson J, Dahabreh IJ, Rothwell PM, Altman DG, Hayward RA. Risk treatment effect heterogeneity: Re-analysis individual participant data 32 large clinical trials. International Journal Epidemiology 2016:dyw118. https://doi.org/10.1093/ije/dyw118.[8] Burke JF, Hayward RA, Nelson JP, Kent DM. Using internally developed risk models assess heterogeneity treatment effects clinical trials. Circulation: Cardiovascular Quality Outcomes 2014;7:163–9. https://doi.org/10.1161/circoutcomes.113.000497.[9] Abadie , Chingos MM, West MR. Endogenous stratification randomized experiments. Review Economics Statistics 2018;100:567–80. https://doi.org/10.1162/rest_a_00732.[10] Harrell FE, Lee KL, Pollock BG. Regression models clinical studies: Determining relationships predictors response. JNCI Journal National Cancer Institute 1988;80:1198–202. https://doi.org/10.1093/jnci/80.15.1198.[11] Klaveren D van, Steyerberg EW, Serruys PW, Kent DM. proposed “concordance-statistic benefit” provided useful metric modeling heterogeneous treatment effects. Journal Clinical Epidemiology 2018;94:59–68. https://doi.org/10.1016/j.jclinepi.2017.10.021.[12] Califf RM, Woodlief LH, Harrell FE, Lee KL, White HD, Guerci , et al. Selection thrombolytic therapy individual patients: Development clinical model. American Heart Journal 1997;133:630–9. https://doi.org/10.1016/s0002-8703(97)70164-9.[13] Steyerberg EW, Bossuyt PMM, Lee KL. Clinical trials acute myocardial infarction: adjust baseline characteristics? American Heart Journal 2000;139:745–51. https://doi.org/10.1016/s0002-8703(00)90001-2.[14] Rothwell PM. Can overall results clinical trials applied patients? Lancet 1995;345:1616–9. https://doi.org/10.1016/s0140-6736(95)90120-5.[15] Rysavy MA, Li L, Tyson JE, Jensen EA, Das , Ambalavanan N, et al. vitamin injections prevent bronchopulmonary dysplasia death reserved high-risk infants? Reanalysis national institute child health human development neonatal research network randomized trial. Journal Pediatrics 2021;236:78–85.e5. https://doi.org/10.1016/j.jpeds.2021.05.022.[16] Sussman JB, Kent DM, Nelson JP, Hayward RA. Improving diabetes prevention benefit based tailored treatment: Risk based reanalysis diabetes prevention program. BMJ 2015;350:h454–4. https://doi.org/10.1136/bmj.h454.[17] Glasziou PP, Irwig LM. evidence based approach individualising treatment. BMJ 1995;311:1356–9. https://doi.org/10.1136/bmj.311.7016.1356.[18] Athey S, Tibshirani J, Wager S. Generalized random forests. Annals Statistics 2019;47. https://doi.org/10.1214/18-aos1709.[19] Lu M, Sadiq S, Feaster DJ, Ishwaran H. Estimating individual treatment effect observational data using random forest methods. Journal Computational Graphical Statistics 2018;27:209–19. https://doi.org/10.1080/10618600.2017.1356325.[20] Wager S, Athey S. Estimation inference heterogeneous treatment effects using random forests. Journal American Statistical Association 2018;113:1228–42. https://doi.org/10.1080/01621459.2017.1319839.[21] Powers S, Qian J, Jung K, Schuler , Shah NH, Hastie T, et al. methods heterogeneous treatment effect estimation high dimensions. Statistics Medicine 2018;37:1767–87.[22] Farooq V, Van Klaveren D, Steyerberg EW, Meliga E, Vergouwe Y, Chieffo , et al. Anatomical clinical characteristics guide decision making coronary artery bypass surgery percutaneous coronary intervention individual patients: Development validation syntax score ii. Lancet 2013;381:639–50.[23] Takahashi K, Serruys PW, Fuster V, Farkouh , Spertus JA, Cohen DJ, et al. Redevelopment validation syntax score ii individualise decision making percutaneous surgical revascularisation patients complex coronary artery disease: Secondary analysis multicentre randomised controlled syntaxes trial external cohort validation. Lancet 2020;396:1399–412.[24] Harrell FE. Regression modeling strategies. vol. 330. Springer; 2017.[25] Austin PC, Steyerberg EW. integrated calibration index (ICI) related metrics quantifying calibration logistic regression models. Statistics Medicine 2019;38:4051–65. https://doi.org/10.1002/sim.8281.","code":""}]
